<!DOCTYPE html>
<html lang="fi">
<head>
<meta charset="UTF-8">
<title>KuPS & KalPa ‚Äì Seuraavat pelit</title>
<style>
body {
  font-family: Arial, sans-serif;
  background:#f5f5f5;
  display: flex;
  flex-direction: column;
  min-height: 100vh;
  margin: 0;
}

h1 { text-align:center; margin-bottom: 30px; }

.container-wrapper {
  flex: 1;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
}

.container {
  display: flex;
  flex-direction: column;
  gap: 30px;
  width: 90%;
  max-width: 500px;
}

.team {
  background:#fff;
  padding:20px;
  border-radius:12px;
  box-shadow:0 4px 10px rgba(0,0,0,0.15);
  text-align:center;
}

.match {
  border-bottom:1px solid #ddd;
  padding:10px 0;
}

.match:last-child { border-bottom:none; }

.date {
  font-weight:bold;
  margin-bottom: 5px;
  display: block;
}

.match-days {
  font-size:0.9em;
  color:#555;
}

footer {
  text-align: center;
  font-size: 0.9em;
  color: #333;
  margin-top: 20px;
  padding: 10px 0;
}
footer a {
  text-decoration: none;
  color: #1a73e8;
  font-weight: bold;
}
footer a:hover {
  text-decoration: underline;
}
</style>
</head>
<body>

<h1>Seuraavat pelit</h1>

<div class="container-wrapper">
  <div class="container">
    <div class="team">
      <h2>‚öΩ KuPS</h2>
      <div id="kups">Ladataan...</div>
    </div>

    <div class="team">
      <h2>üèí KalPa</h2>
      <div id="kalpa">Ladataan...</div>
    </div>
  </div>
</div>

<footer>
  <span>Kerro my√∂s kaverille üëâ <a href="https://bit.ly/kupskalpa" target="_blank">https://bit.ly/kupskalpa</a></span>
</footer>

<script>
// Palauttaa erotuksen p√§ivin√§: 0 = t√§n√§√§n, 1 = huomenna jne.
function getDaysLeft(targetDate) {
    const today = new Date();
    const todayMidnight = new Date(today.getFullYear(), today.getMonth(), today.getDate());
    const targetMidnight = new Date(targetDate.getFullYear(), targetDate.getMonth(), targetDate.getDate());

    const diffTime = targetMidnight - todayMidnight; // millisekunteina
    return diffTime / (1000 * 60 * 60 * 24);
}

function renderNextMatches(containerId, matchesArr, count=3){
    const container = document.getElementById(containerId);
    container.innerHTML = "";

    const now = new Date();
    const upcoming = matchesArr
        .map(m => ({...m, dateObj: new Date(m.date)}))
        .filter(m => m.dateObj >= now)
        .sort((a,b) => a.dateObj - b.dateObj)
        .slice(0, count);

    if (upcoming.length === 0){
        container.innerText = "Ei l√§hiaikoina pelej√§.";
        return;
    }

    upcoming.forEach(m => {
        const div = document.createElement("div");
        div.className = "match";

        const dateStr = m.dateObj.toLocaleDateString("fi-FI") + " " +
                        m.dateObj.toLocaleTimeString("fi-FI", {hour:'2-digit', minute:'2-digit'});

        const diffDays = getDaysLeft(m.dateObj);
        const diffText = diffDays === 0 ? "T√§n√§√§n" : `${diffDays} p√§iv√§n p√§√§st√§`;

        div.innerHTML = `<span class="date">${dateStr}</span>
                         <div>${m.home} ‚Äì ${m.away}</div>
                         <div class="match-days">${diffText}</div>`;
        container.appendChild(div);
    });
}

// Hae ottelut matches.json -tiedostosta
fetch("matches.json")
    .then(res => res.json())
    .then(data => {
        renderNextMatches("kups", data.kups);
        renderNextMatches("kalpa", data.kalpa);
    })
    .catch(e => {
        console.error("JSON fetch error:", e);
        document.getElementById("kups").innerText = "Ottelutiedot ei saatavilla.";
        document.getElementById("kalpa").innerText = "Ottelutiedot ei saatavilla.";
    });
</script>

</body>
</html>
